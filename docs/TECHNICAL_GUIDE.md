# ğŸ”§ é‚®ç®±ç›‘æ§ç³»ç»ŸæŠ€æœ¯æŒ‡å—

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é‚®ç®±ç›‘æ§ç³»ç»Ÿæ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯å±‚ (Frontend)                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   HTML5     â”‚ â”‚    CSS3     â”‚ â”‚ JavaScript  â”‚           â”‚
â”‚  â”‚  Templates  â”‚ â”‚ Bootstrap 5 â”‚ â”‚   åŸç”ŸJS    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åº”ç”¨å±‚ (Application)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Flask Web   â”‚ â”‚  é‚®ä»¶ç›‘æ§   â”‚ â”‚  æ”¯ä»˜ç³»ç»Ÿ   â”‚           â”‚
â”‚  â”‚   åº”ç”¨      â”‚ â”‚   ç»„ä»¶      â”‚ â”‚   é›†æˆ      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸šåŠ¡å±‚ (Business Logic)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  ç”¨æˆ·ç®¡ç†   â”‚ â”‚  é‚®ä»¶å¤„ç†   â”‚ â”‚  è®¡è´¹ç³»ç»Ÿ   â”‚           â”‚
â”‚  â”‚   æ¨¡å—      â”‚ â”‚   æ¨¡å—      â”‚ â”‚   æ¨¡å—      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®å±‚ (Data Access)                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ æ•°æ®åº“ç®¡ç†  â”‚ â”‚  æ–‡ä»¶å­˜å‚¨   â”‚ â”‚  ç¼“å­˜ç³»ç»Ÿ   â”‚           â”‚
â”‚  â”‚   æ¨¡å—      â”‚ â”‚   æ¨¡å—      â”‚ â”‚  (å¯é€‰)     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åŸºç¡€è®¾æ–½å±‚ (Infrastructure)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  MySQL      â”‚ â”‚  æ–‡ä»¶ç³»ç»Ÿ   â”‚ â”‚   IMAP      â”‚           â”‚
â”‚  â”‚  æ•°æ®åº“     â”‚ â”‚   å­˜å‚¨      â”‚ â”‚  é‚®ä»¶æœåŠ¡   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. Webåº”ç”¨å±‚ (app.py)
- **Flaskæ¡†æ¶**: æä¾›HTTPæœåŠ¡å’Œè·¯ç”±ç®¡ç†
- **æ¨¡æ¿å¼•æ“**: Jinja2æ¨¡æ¿æ¸²æŸ“
- **ä¼šè¯ç®¡ç†**: ç”¨æˆ·ç™»å½•çŠ¶æ€ç»´æŠ¤
- **APIæ¥å£**: RESTful APIè®¾è®¡

#### 2. é‚®ä»¶ç›‘æ§ç³»ç»Ÿ
- **å®æ—¶ç›‘æ§å™¨** (realtime_monitor.py): IMAPåè®®ç›‘æ§
- **é‚®ä»¶è§£æå™¨** (email_parser.py): .emlæ–‡ä»¶è§£æ
- **ç»„ä»¶è¿æ¥å™¨** (component_connector.py): ç»„ä»¶åè°ƒ
- **QQé‚®ç®±ç›‘æ§** (qq_email_monitor.py): ä¸“ç”¨ç›‘æ§å™¨

#### 3. æ•°æ®ç®¡ç†å±‚
- **æ•°æ®åº“ç®¡ç†å™¨** (db_manager.py): MySQLè¿æ¥æ± ç®¡ç†
- **é…ç½®ç®¡ç†** (config.py): ç³»ç»Ÿå‚æ•°é…ç½®
- **é‚®ä»¶é…ç½®** (email_config.py): é‚®ç®±è¿æ¥é…ç½®

#### 4. æ”¯ä»˜ç³»ç»Ÿ
- **æ˜“æ”¯ä»˜é›†æˆ** (yipay_utils.py): ç¬¬ä¸‰æ–¹æ”¯ä»˜
- **æ”¯ä»˜ç›‘æ§** (payment_monitor.py): æ”¯ä»˜çŠ¶æ€è·Ÿè¸ª
- **è®¡è´¹å¤„ç†** (email_cost_handler.py): è´¹ç”¨è®¡ç®—

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

#### ç”¨æˆ·è¡¨ (users)
```sql
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(255) NULL,
    is_vip TINYINT(1) DEFAULT 0,
    is_admin TINYINT(1) DEFAULT 0,
    balance DECIMAL(10,2) DEFAULT 0.00,
    vip_expire_date DATETIME NULL,
    monthly_email_count INT DEFAULT 0,
    vip_email_count INT DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### é‚®ä»¶è¡¨ (emails)
```sql
CREATE TABLE emails (
    id INT AUTO_INCREMENT PRIMARY KEY,
    email_id VARCHAR(255) NOT NULL UNIQUE,
    sender VARCHAR(255) NOT NULL,
    recipient VARCHAR(255) NOT NULL,
    subject TEXT,
    content LONGTEXT,
    html_content LONGTEXT,
    received_at DATETIME NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ç”¨æˆ·é‚®ç®±è¡¨ (user_emails)
```sql
CREATE TABLE user_emails (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    email_address VARCHAR(255) NOT NULL UNIQUE,
    domain VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

### æ•°æ®å…³ç³»å›¾

```
users (1) â”€â”€â”€â”€â”€â”€â”€â”€ (N) user_emails
  â”‚                      â”‚
  â”‚                      â”‚
  â””â”€â”€ (1) â”€â”€â”€â”€â”€â”€â”€â”€ (N) emails â”€â”€â”€â”€â”€â”€â”€â”€ (N) attachments
           user_id              email_id
```

## ğŸ”„ ä¸šåŠ¡æµç¨‹

### é‚®ä»¶ç›‘æ§æµç¨‹

```mermaid
graph TD
    A[å¯åŠ¨ç›‘æ§] --> B[è¿æ¥IMAPæœåŠ¡å™¨]
    B --> C[æ£€æŸ¥æ–°é‚®ä»¶]
    C --> D{æœ‰æ–°é‚®ä»¶?}
    D -->|æ˜¯| E[ä¸‹è½½é‚®ä»¶]
    D -->|å¦| F[ç­‰å¾…6ç§’]
    E --> G[è§£æé‚®ä»¶å†…å®¹]
    G --> H[æå–é™„ä»¶]
    H --> I[å­˜å‚¨åˆ°æ•°æ®åº“]
    I --> J[ç”Ÿæˆå‰ç«¯æ•°æ®]
    J --> F
    F --> C
```

### ç”¨æˆ·æ³¨å†Œæµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·è®¿é—®æ³¨å†Œé¡µ] --> B[å¡«å†™æ³¨å†Œä¿¡æ¯]
    B --> C[æäº¤è¡¨å•]
    C --> D[æœåŠ¡å™¨éªŒè¯]
    D --> E{éªŒè¯é€šè¿‡?}
    E -->|æ˜¯| F[åˆ›å»ºç”¨æˆ·è´¦æˆ·]
    E -->|å¦| G[è¿”å›é”™è¯¯ä¿¡æ¯]
    F --> H[åˆå§‹åŒ–ç”¨æˆ·æ•°æ®]
    H --> I[è·³è½¬åˆ°ç™»å½•é¡µ]
    G --> B
```

### é‚®ä»¶å‘é€æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·å†™é‚®ä»¶] --> B[é€‰æ‹©å‘ä»¶äººé‚®ç®±]
    B --> C[å¡«å†™é‚®ä»¶å†…å®¹]
    C --> D[ä¸Šä¼ é™„ä»¶(å¯é€‰)]
    D --> E[ç‚¹å‡»å‘é€]
    E --> F[æ£€æŸ¥ä½™é¢]
    F --> G{ä½™é¢å……è¶³?}
    G -->|æ˜¯| H[æ‰£é™¤è´¹ç”¨]
    G -->|å¦| I[æç¤ºå……å€¼]
    H --> J[è°ƒç”¨å‘é€API]
    J --> K[ä¿å­˜åˆ°æ•°æ®åº“]
    K --> L[è¿”å›å‘é€ç»“æœ]
    I --> A
```

## ğŸ”§ æŠ€æœ¯æ ˆè¯¦è§£

### åç«¯æŠ€æœ¯

#### Python 3.9+
- **Flask 2.3.3**: Webæ¡†æ¶
- **mysql-connector-python 8.1.0**: MySQLé©±åŠ¨
- **bcrypt 4.0.1**: å¯†ç åŠ å¯†
- **requests 2.31.0**: HTTPå®¢æˆ·ç«¯

#### æ•°æ®åº“
- **MySQL 8.0**: ä¸»æ•°æ®åº“
- **è¿æ¥æ± **: æ”¯æŒå¹¶å‘è¿æ¥
- **äº‹åŠ¡æ”¯æŒ**: æ•°æ®ä¸€è‡´æ€§ä¿è¯
- **ç´¢å¼•ä¼˜åŒ–**: æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–

### å‰ç«¯æŠ€æœ¯

#### HTML5 + CSS3
- **è¯­ä¹‰åŒ–æ ‡ç­¾**: æé«˜å¯è®¿é—®æ€§
- **å“åº”å¼è®¾è®¡**: æ”¯æŒå¤šè®¾å¤‡
- **CSS Grid/Flexbox**: ç°ä»£å¸ƒå±€

#### Bootstrap 5
- **ç»„ä»¶åº“**: ä¸°å¯Œçš„UIç»„ä»¶
- **ä¸»é¢˜å®šåˆ¶**: è‡ªå®šä¹‰æ ·å¼
- **å›¾æ ‡ç³»ç»Ÿ**: Bootstrap Icons

#### JavaScript
- **åŸç”ŸJS**: æ— æ¡†æ¶ä¾èµ–
- **AJAX**: å¼‚æ­¥æ•°æ®äº¤äº’
- **è¡¨å•éªŒè¯**: å®¢æˆ·ç«¯éªŒè¯

### é‚®ä»¶æŠ€æœ¯

#### IMAPåè®®
- **SSL/TLSåŠ å¯†**: å®‰å…¨è¿æ¥
- **å®æ—¶ç›‘æ§**: 6ç§’æ£€æŸ¥é—´éš”
- **å¤šé‚®ç®±æ”¯æŒ**: æ”¯æŒå¤šä¸ªé‚®ç®±è´¦æˆ·

#### é‚®ä»¶è§£æ
- **MIMEè§£æ**: æ”¯æŒå¤šåª’ä½“é‚®ä»¶
- **ç¼–ç å¤„ç†**: è‡ªåŠ¨è¯†åˆ«å­—ç¬¦ç¼–ç 
- **é™„ä»¶æå–**: è‡ªåŠ¨ä¿å­˜é™„ä»¶æ–‡ä»¶

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–

1. **è¿æ¥æ± ç®¡ç†**
   ```python
   # ä½¿ç”¨è¿æ¥æ± é¿å…é¢‘ç¹è¿æ¥
   pool = mysql.connector.pooling.MySQLConnectionPool(
       pool_name="email_pool",
       pool_size=10,
       **db_config
   )
   ```

2. **ç´¢å¼•ä¼˜åŒ–**
   ```sql
   -- é‚®ä»¶æŸ¥è¯¢ç´¢å¼•
   CREATE INDEX idx_recipient ON emails(recipient);
   CREATE INDEX idx_received_at ON emails(received_at);
   
   -- ç”¨æˆ·é‚®ç®±ç´¢å¼•
   CREATE INDEX idx_user_email ON user_emails(user_id, email_address);
   ```

3. **æŸ¥è¯¢ä¼˜åŒ–**
   ```python
   # åˆ†é¡µæŸ¥è¯¢é¿å…å¤§é‡æ•°æ®åŠ è½½
   def get_emails_paginated(user_id, page=1, per_page=20):
       offset = (page - 1) * per_page
       query = """
       SELECT * FROM emails 
       WHERE recipient IN (SELECT email_address FROM user_emails WHERE user_id = %s)
       ORDER BY received_at DESC 
       LIMIT %s OFFSET %s
       """
   ```

### åº”ç”¨ä¼˜åŒ–

1. **å¼‚æ­¥å¤„ç†**
   ```python
   # é‚®ä»¶å¤„ç†å¼‚æ­¥é˜Ÿåˆ—
   import threading
   import queue
   
   email_queue = queue.Queue()
   
   def process_emails():
       while True:
           email_data = email_queue.get()
           # å¤„ç†é‚®ä»¶é€»è¾‘
           email_queue.task_done()
   ```

2. **ç¼“å­˜æœºåˆ¶**
   ```python
   # ç”¨æˆ·ä¼šè¯ç¼“å­˜
   from functools import lru_cache
   
   @lru_cache(maxsize=128)
   def get_user_info(user_id):
       # ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
       return db_manager.get_user_by_id(user_id)
   ```

3. **é™æ€èµ„æºä¼˜åŒ–**
   ```html
   <!-- CSS/JSå‹ç¼©å’Œåˆå¹¶ -->
   <link rel="stylesheet" href="/static/css/app.min.css">
   <script src="/static/js/app.min.js"></script>
   ```

## ğŸ”’ å®‰å…¨è®¾è®¡

### è®¤è¯å’Œæˆæƒ

1. **å¯†ç å®‰å…¨**
   ```python
   import bcrypt
   
   # å¯†ç åŠ å¯†
   def hash_password(password):
       return bcrypt.hashpw(password.encode('utf-8'), bcrypt.gensalt())
   
   # å¯†ç éªŒè¯
   def verify_password(password, hashed):
       return bcrypt.checkpw(password.encode('utf-8'), hashed)
   ```

2. **ä¼šè¯ç®¡ç†**
   ```python
   # Flaskä¼šè¯é…ç½®
   app.config['SESSION_COOKIE_SECURE'] = True
   app.config['SESSION_COOKIE_HTTPONLY'] = True
   app.config['SESSION_COOKIE_SAMESITE'] = 'Lax'
   ```

3. **æƒé™æ§åˆ¶**
   ```python
   def require_admin(f):
       @wraps(f)
       def decorated_function(*args, **kwargs):
           if not session.get('is_admin'):
               return redirect(url_for('login'))
           return f(*args, **kwargs)
       return decorated_function
   ```

### æ•°æ®å®‰å…¨

1. **SQLæ³¨å…¥é˜²æŠ¤**
   ```python
   # ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
   cursor.execute("SELECT * FROM users WHERE username = %s", (username,))
   ```

2. **XSSé˜²æŠ¤**
   ```python
   from markupsafe import escape
   
   # è¾“å‡ºè½¬ä¹‰
   safe_content = escape(user_input)
   ```

3. **CSRFé˜²æŠ¤**
   ```python
   # Flask-WTF CSRFä¿æŠ¤
   from flask_wtf.csrf import CSRFProtect
   csrf = CSRFProtect(app)
   ```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### åº”ç”¨ç›‘æ§

1. **æ€§èƒ½ç›‘æ§**
   ```python
   import time
   import logging
   
   def monitor_performance(func):
       def wrapper(*args, **kwargs):
           start_time = time.time()
           result = func(*args, **kwargs)
           end_time = time.time()
           logging.info(f"{func.__name__} æ‰§è¡Œæ—¶é—´: {end_time - start_time:.2f}ç§’")
           return result
       return wrapper
   ```

2. **é”™è¯¯ç›‘æ§**
   ```python
   @app.errorhandler(500)
   def internal_error(error):
       logging.error(f"æœåŠ¡å™¨é”™è¯¯: {error}")
       return render_template('error.html'), 500
   ```

### æ—¥å¿—ç³»ç»Ÿ

```python
import logging
from logging.handlers import RotatingFileHandler

# é…ç½®æ—¥å¿—
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s %(levelname)s %(name)s %(message)s'
)

# æ–‡ä»¶æ—¥å¿—
file_handler = RotatingFileHandler('logs/app.log', maxBytes=10240, backupCount=10)
app.logger.addHandler(file_handler)
```

## ğŸ”§ å¼€å‘ç¯å¢ƒ

### æœ¬åœ°å¼€å‘è®¾ç½®

1. **ç¯å¢ƒå‡†å¤‡**
   ```bash
   # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   venv\Scripts\activate     # Windows
   
   # å®‰è£…ä¾èµ–
   pip install -r requirements.txt
   ```

2. **æ•°æ®åº“è®¾ç½®**
   ```bash
   # å¯åŠ¨MySQL
   mysql -u root -p
   
   # åˆ›å»ºæ•°æ®åº“
   CREATE DATABASE cloudfare_qq_mail_dev;
   
   # åˆå§‹åŒ–è¡¨ç»“æ„
   python database/setup_database.py
   ```

3. **é…ç½®æ–‡ä»¶**
   ```python
   # å¼€å‘ç¯å¢ƒé…ç½®
   DEBUG = True
   DB_HOST = 'localhost'
   DB_NAME = 'cloudfare_qq_mail_dev'
   ```

### æµ‹è¯•ç¯å¢ƒ

```python
# å•å…ƒæµ‹è¯•
import unittest

class TestEmailParser(unittest.TestCase):
    def test_parse_email(self):
        parser = EmailParser()
        result = parser.parse_email('test.eml')
        self.assertIsNotNone(result)

if __name__ == '__main__':
    unittest.main()
```

## ğŸ“ˆ æ‰©å±•æ€§è®¾è®¡

### å¾®æœåŠ¡æ¶æ„å‡†å¤‡

```python
# æœåŠ¡æ‹†åˆ†å‡†å¤‡
class EmailService:
    def __init__(self):
        self.monitor = EmailMonitor()
        self.parser = EmailParser()
    
    def process_email(self, email_data):
        # é‚®ä»¶å¤„ç†é€»è¾‘
        pass

class UserService:
    def __init__(self):
        self.db = DatabaseManager()
    
    def create_user(self, user_data):
        # ç”¨æˆ·åˆ›å»ºé€»è¾‘
        pass
```

### APIç‰ˆæœ¬æ§åˆ¶

```python
# APIç‰ˆæœ¬è·¯ç”±
@app.route('/api/v1/emails')
def get_emails_v1():
    # v1ç‰ˆæœ¬API
    pass

@app.route('/api/v2/emails')
def get_emails_v2():
    # v2ç‰ˆæœ¬API
    pass
```

è¿™ä¸ªæŠ€æœ¯æŒ‡å—ä¸ºå¼€å‘è€…æä¾›äº†ç³»ç»Ÿçš„å®Œæ•´æŠ€æœ¯è§†å›¾ï¼ŒåŒ…æ‹¬æ¶æ„è®¾è®¡ã€æ•°æ®åº“è®¾è®¡ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨è€ƒè™‘ç­‰å„ä¸ªæ–¹é¢çš„è¯¦ç»†ä¿¡æ¯ã€‚
